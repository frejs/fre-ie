{"version":3,"file":"freie.js","sources":["../polyfil.js","../node_modules/fre/dist/fre.esm.js","../src/index.js"],"sourcesContent":["!window.addEventListener &&\r\n  (function (WindowPrototype, DocumentPrototype, ElementPrototype, addEventListener, removeEventListener, dispatchEvent, registry) {\r\n    WindowPrototype[addEventListener] = DocumentPrototype[addEventListener] = ElementPrototype[addEventListener] = function (type, listener) {\r\n      var target = this\r\n\r\n      registry.unshift([\r\n        target,\r\n        type,\r\n        listener,\r\n        function (event) {\r\n          event.currentTarget = target\r\n          event.preventDefault = function () {\r\n            event.returnValue = false\r\n          }\r\n          event.stopPropagation = function () {\r\n            event.cancelBubble = true\r\n          }\r\n          event.target = event.srcElement || target\r\n\r\n          listener.call(target, event)\r\n        },\r\n      ])\r\n\r\n      this.attachEvent('on' + type, registry[0][3])\r\n    }\r\n\r\n    WindowPrototype[removeEventListener] = DocumentPrototype[removeEventListener] = ElementPrototype[removeEventListener] = function (\r\n      type,\r\n      listener\r\n    ) {\r\n      for (var index = 0, register; (register = registry[index]); ++index) {\r\n        if (register[0] == this && register[1] == type && register[2] == listener) {\r\n          return this.detachEvent('on' + type, registry.splice(index, 1)[0][3])\r\n        }\r\n      }\r\n    }\r\n\r\n    WindowPrototype[dispatchEvent] = DocumentPrototype[dispatchEvent] = ElementPrototype[dispatchEvent] = function (eventObject) {\r\n      return this.fireEvent('on' + eventObject.type, eventObject)\r\n    }\r\n  })(Window.prototype, HTMLDocument.prototype, Element.prototype, 'addEventListener', 'removeEventListener', 'dispatchEvent', [])\r\n\r\ndocument.createTextNode = function (data) {\r\n  const text = document.createElement('x-text')\r\n  text.innerText = data\r\n\r\n  return text\r\n}\r\n\r\nif (!('performance' in window)) {\r\n  window.performance = {}\r\n}\r\nvar perf = window.performance\r\nwindow.performance.now =\r\n  perf.now ||\r\n  perf.mozNow ||\r\n  perf.msNow ||\r\n  perf.oNow ||\r\n  perf.webkitNow ||\r\n  Date.now ||\r\n  function () {\r\n    return new Date().getTime()\r\n  }\r\n","const isArr = Array.isArray;\r\nconst isStr = s => typeof s === 'string' || typeof s === 'number';\r\nconst MEMO = 0;\r\n\r\nfunction h(type, attrs, ...args) {\r\n  let props = attrs || {};\r\n  let key = props.key || null;\r\n  let ref = props.ref || null;\r\n  let children = [];\r\n\r\n  for (let i = 0; i < args.length; i++) {\r\n    let vnode = args[i];\r\n    if (vnode == null || vnode === true || vnode === false) ; else if (isStr(vnode)) {\r\n      children.push(createText(vnode));\r\n    } else {\r\n      while (isArr(vnode) && vnode.some(v => isArr(v))) {\r\n        vnode = [].concat(...vnode);\r\n      }\r\n      children.push(vnode);\r\n    }\r\n  }\r\n\r\n  if (children.length) {\r\n    props.children = children.length === 1 ? children[0] : children;\r\n  }\r\n\r\n  delete props.key;\r\n  delete props.ref;\r\n\r\n  return { type, props, key, ref }\r\n}\r\n\r\nfunction createText(vnode) {\r\n  return { type: 'text', props: { nodeValue: vnode } }\r\n}\r\n\r\nfunction Fragment(props) {\r\n  return props.children\r\n}\r\n\r\nfunction memo(fn) {\r\n  fn.tag = MEMO;\r\n  return fn\r\n}\n\nfunction updateElement(dom, oldProps, newProps) {\r\n  for (let name in { ...oldProps, ...newProps }) {\r\n    let oldValue = oldProps[name];\r\n    let newValue = newProps[name];\r\n\r\n    if (oldValue == newValue || name === 'children') ; else if (name === 'style') {\r\n      for (const k in { ...oldValue, ...newValue }) {\r\n        if (!(oldValue && newValue && oldValue[k] === newValue[k])) {\r\n          dom[name][k] = (newValue && newValue[k]) || '';\r\n        }\r\n      }\r\n    } else if (name[0] === 'o' && name[1] === 'n') {\r\n      name = name.slice(2).toLowerCase();\r\n      if (oldValue) dom.removeEventListener(name, oldValue);\r\n      dom.addEventListener(name, newValue);\r\n    } else if (name in dom && !(dom instanceof SVGElement)) {\r\n      dom[name] = newValue == null ? '' : newValue;\r\n    } else if (newValue == null || newValue === false) {\r\n      dom.removeAttribute(name);\r\n    } else {\r\n      dom.setAttribute(name, newValue);\r\n    }\r\n  }\r\n}\r\n\r\nfunction createElement(fiber) {\r\n  const dom =\r\n    fiber.type === 'text'\r\n      ? document.createTextNode('')\r\n      : fiber.tag === SVG\r\n      ? document.createElementNS('http://www.w3.org/2000/svg', fiber.type)\r\n      : document.createElement(fiber.type);\r\n  updateElement(dom, {}, fiber.props);\r\n  return dom\r\n}\n\nlet cursor = 0;\r\n\r\nfunction resetCursor() {\r\n  cursor = 0;\r\n}\r\n\r\nfunction useState(initState) {\r\n  return useReducer(null, initState)\r\n}\r\n\r\nfunction useReducer(reducer, initState) {\r\n  const [hook, current] = getHook(cursor++);\r\n  const setter = value => {\r\n    let newValue = reducer\r\n      ? reducer(hook[0], value)\r\n      : isFn(value)\r\n      ? value(hook[0])\r\n      : value;\r\n    if (newValue !== hook[0]) {\r\n      hook[0] = newValue;\r\n      scheduleWork(current);\r\n    }\r\n  };\r\n\r\n  if (hook.length) {\r\n    return [hook[0], setter]\r\n  } else {\r\n    hook[0] = initState;\r\n    return [initState, setter]\r\n  }\r\n}\r\n\r\nfunction useEffect(cb, deps) {\r\n  return effectImpl(cb, deps, 'effect')\r\n}\r\n\r\nfunction useLayout(cb, deps) {\r\n  return effectImpl(cb, deps, 'layout')\r\n}\r\n\r\nfunction effectImpl(cb, deps, key) {\r\n  let [hook, current] = getHook(cursor++);\r\n  if (isChanged(hook[1], deps)) {\r\n    hook[0] = useCallback(cb, deps);\r\n    hook[1] = deps;\r\n    current.hooks[key].push(hook);\r\n  }\r\n}\r\n\r\nfunction useMemo(cb, deps) {\r\n  let hook = getHook(cursor++)[0];\r\n  if (isChanged(hook[1], deps)) {\r\n    hook[1] = deps;\r\n    return (hook[0] = cb())\r\n  }\r\n  return hook[0]\r\n}\r\n\r\nfunction useCallback(cb, deps) {\r\n  return useMemo(() => cb, deps)\r\n}\r\n\r\nfunction useRef(current) {\r\n  return useMemo(() => ({ current }), [])\r\n}\r\n\r\nfunction getHook(cursor) {\r\n  const current = getCurrentFiber();\r\n  let hooks =\r\n    current.hooks || (current.hooks = { list: [], effect: [], layout: [] });\r\n  if (cursor >= hooks.list.length) {\r\n    hooks.list.push([]);\r\n  }\r\n  return [hooks.list[cursor], current]\r\n}\r\n\r\nfunction isChanged(a, b) {\r\n  return !a || b.some((arg, index) => arg !== a[index])\r\n}\n\nfunction push(heap, node) {\r\n  const i = heap.length;\r\n  heap.push(node);\r\n  siftUp(heap, node, i);\r\n}\r\n\r\nfunction pop(heap) {\r\n  const first = heap[0];\r\n  if (!first) return null\r\n  const last = heap.pop();\r\n  if (last !== first) {\r\n    heap[0] = last;\r\n    siftDown(heap, last, 0);\r\n  }\r\n  return first\r\n}\r\n\r\nfunction siftUp(heap, node, i) {\r\n  while (i > 0) {\r\n    const pi = (i - 1) >>> 1;\r\n    const parent = heap[pi];\r\n    if (cmp(parent, node) <= 0) return\r\n    heap[pi] = node;\r\n    heap[i] = parent;\r\n    i = pi;\r\n  }\r\n}\r\n\r\nfunction siftDown(heap, node, i) {\r\n  for (;;) {\r\n    const li = i * 2 + 1;\r\n    const left = heap[li];\r\n    if (li >= heap.length) return\r\n    const ri = li + 1;\r\n    const right = heap[ri];\r\n    const ci = ri < heap.length && cmp(right, left) < 0 ? ri : li;\r\n    const child = heap[ci];\r\n    if (cmp(child, node) > 0) return\r\n    heap[ci] = node;\r\n    heap[i] = child;\r\n    i = ci;\r\n  }\r\n}\r\n\r\nfunction cmp(a, b) {\r\n  return a.dueTime - b.dueTime\r\n}\r\n\r\nfunction peek(heap) {\r\n  return heap[0] || null\r\n}\n\nlet taskQueue = [];\r\nlet currentCallback = null;\r\nlet frameDeadline = 0;\r\nconst frameLength = 1000 / 60;\r\n\r\nfunction scheduleCallback(callback) {\r\n  const currentTime = getTime();\r\n  const startTime = currentTime;\r\n  const timeout = 3000;\r\n  const dueTime = startTime + timeout;\r\n\r\n  let newTask = {\r\n    callback,\r\n    startTime,\r\n    dueTime\r\n  };\r\n\r\n  push(taskQueue, newTask);\r\n  currentCallback = flush;\r\n  planWork();\r\n}\r\n\r\nfunction flush(iniTime) {\r\n  let currentTime = iniTime;\r\n  let currentTask = peek(taskQueue);\r\n\r\n  while (currentTask) {\r\n    const didout = currentTask.dueTime <= currentTime;\r\n    if (!didout && shouldYeild()) break\r\n\r\n    let callback = currentTask.callback;\r\n    currentTask.callback = null;\r\n\r\n    let next = callback(didout);\r\n    next ? (currentTask.callback = next) : pop(taskQueue);\r\n\r\n    currentTask = peek(taskQueue);\r\n    currentTime = getTime();\r\n  }\r\n\r\n  return !!currentTask\r\n}\r\n\r\nfunction flushWork() {\r\n  if (currentCallback) {\r\n    let currentTime = getTime();\r\n    frameDeadline = currentTime + frameLength;\r\n    let more = currentCallback(currentTime);\r\n    more ? planWork() : (currentCallback = null);\r\n  }\r\n}\r\n\r\nconst planWork = (() => {\r\n  if (typeof MessageChannel !== 'undefined') {\r\n    const { port1, port2 } = new MessageChannel();\r\n    port1.onmessage = flushWork;\r\n    return cb => (cb ? requestAnimationFrame(cb) : port2.postMessage(null))\r\n  }\r\n  return cb => setTimeout(cb || flushWork)\r\n})();\r\n\r\nfunction shouldYeild() {\r\n  return getTime() >= frameDeadline\r\n}\r\n\r\nconst getTime = () => performance.now();\n\nconst NOWORK = 0;\r\nconst PLACE = 1;\r\nconst UPDATE = 2;\r\nconst DELETE = 3;\r\n\r\nconst SVG = 4;\r\n\r\nlet preCommit = null;\r\nlet currentFiber = null;\r\nlet WIP = null;\r\nlet updateQueue = [];\r\nlet commitQueue = [];\r\n\r\nfunction render(vnode, node, done) {\r\n  let rootFiber = {\r\n    node,\r\n    props: { children: vnode },\r\n    done\r\n  };\r\n  scheduleWork(rootFiber);\r\n}\r\n\r\nfunction scheduleWork(fiber) {\r\n  if (!fiber.dirty && (fiber.dirty = true)) {\r\n    updateQueue.push(fiber);\r\n  }\r\n  scheduleCallback(reconcileWork);\r\n}\r\n\r\nfunction reconcileWork(didout) {\r\n  if (!WIP) WIP = updateQueue.shift();\r\n  while (WIP && (!shouldYeild() || didout)) {\r\n    WIP = reconcile(WIP);\r\n  }\r\n  if (!didout && WIP) {\r\n    return reconcileWork.bind(null)\r\n  }\r\n  if (preCommit) commitWork(preCommit);\r\n  return null\r\n}\r\n\r\nfunction reconcile(WIP) {\r\n  WIP.parentNode = getParentNode(WIP);\r\n  isFn(WIP.type) ? updateHOOK(WIP) : updateHost(WIP);\r\n  WIP.dirty = WIP.dirty ? false : 0;\r\n  WIP.oldProps = WIP.props;\r\n  commitQueue.push(WIP);\r\n\r\n  if (WIP.child) return WIP.child\r\n  while (WIP) {\r\n    if (!preCommit && WIP.dirty === false) {\r\n      preCommit = WIP;\r\n      return null\r\n    }\r\n    if (WIP.sibling) {\r\n      return WIP.sibling\r\n    }\r\n    WIP = WIP.parent;\r\n  }\r\n}\r\n\r\nfunction updateHOOK(WIP) {\r\n  if (\r\n    WIP.type.tag === MEMO &&\r\n    WIP.dirty == 0 &&\r\n    !shouldUpdate(WIP.oldProps, WIP.props)\r\n  ) {\r\n    cloneChildren(WIP);\r\n    return\r\n  }\r\n  currentFiber = WIP;\r\n  WIP.type.fiber = WIP;\r\n  resetCursor();\r\n  let children = WIP.type(WIP.props);\r\n  if (isStr(children)) {\r\n    children = createText(children);\r\n  }\r\n  reconcileChildren(WIP, children);\r\n}\r\n\r\nfunction updateHost(WIP) {\r\n  if (!WIP.node) {\r\n    if (WIP.type === 'svg') WIP.tag = SVG;\r\n    WIP.node = createElement(WIP);\r\n  }\r\n  let p = WIP.parentNode || {};\r\n  WIP.insertPoint = p.last || null;\r\n  p.last = WIP;\r\n  WIP.node.last = null;\r\n  reconcileChildren(WIP, WIP.props.children);\r\n}\r\n\r\nfunction getParentNode(fiber) {\r\n  while ((fiber = fiber.parent)) {\r\n    if (!isFn(fiber.type)) return fiber.node\r\n  }\r\n}\r\n\r\nfunction reconcileChildren(WIP, children) {\r\n  if (!children) return\r\n  delete WIP.child;\r\n  const oldFibers = WIP.kids;\r\n  const newFibers = (WIP.kids = hashfy(children));\r\n\r\n  let reused = {};\r\n\r\n  for (const k in oldFibers) {\r\n    let newFiber = newFibers[k];\r\n    let oldFiber = oldFibers[k];\r\n\r\n    if (newFiber && newFiber.type === oldFiber.type) {\r\n      reused[k] = oldFiber;\r\n    } else {\r\n      oldFiber.op = DELETE;\r\n      commitQueue.push(oldFiber);\r\n    }\r\n  }\r\n\r\n  let prevFiber = null;\r\n  let alternate = null;\r\n\r\n  for (const k in newFibers) {\r\n    let newFiber = newFibers[k];\r\n    let oldFiber = reused[k];\r\n\r\n    if (oldFiber) {\r\n      alternate = createFiber(oldFiber, UPDATE);\r\n      newFiber.op = UPDATE;\r\n      newFiber = { ...alternate, ...newFiber };\r\n      newFiber.lastProps = alternate.props;\r\n      if (shouldPlace(newFiber)) {\r\n        newFiber.op = PLACE;\r\n      }\r\n    } else {\r\n      newFiber = createFiber(newFiber, PLACE);\r\n    }\r\n\r\n    newFibers[k] = newFiber;\r\n    newFiber.parent = WIP;\r\n\r\n    if (prevFiber) {\r\n      prevFiber.sibling = newFiber;\r\n    } else {\r\n      if (WIP.tag === SVG) newFiber.tag = SVG;\r\n      WIP.child = newFiber;\r\n    }\r\n    prevFiber = newFiber;\r\n  }\r\n\r\n  if (prevFiber) prevFiber.sibling = null;\r\n}\r\n\r\nfunction cloneChildren(fiber) {\r\n  if (!fiber.child) return\r\n  let child = fiber.child;\r\n  let newChild = child;\r\n  newChild.op = NOWORK;\r\n  fiber.child = newChild;\r\n  newChild.parent = fiber;\r\n  newChild.sibling = null;\r\n}\r\n\r\nfunction shouldUpdate(a, b) {\r\n  for (let i in a) if (!(i in b)) return true\r\n  for (let i in b) if (a[i] !== b[i]) return true\r\n  return false\r\n}\r\n\r\nfunction shouldPlace(fiber) {\r\n  let p = fiber.parent;\r\n  if (isFn(p.type)) return p.key && !p.dirty\r\n  return fiber.key\r\n}\r\n\r\nfunction commitWork(fiber) {\r\n  commitQueue.forEach(c => c.parent && commit(c));\r\n  fiber.done && fiber.done();\r\n  commitQueue = [];\r\n  preCommit = null;\r\n  WIP = null;\r\n}\r\n\r\nfunction commit(fiber) {\r\n  const { op, parentNode, node, ref, hooks } = fiber;\r\n  if (op === NOWORK) ; else if (op === DELETE) {\r\n    hooks && hooks.list.forEach(cleanup);\r\n    cleanupRef(fiber.kids);\r\n    while (isFn(fiber.type)) fiber = fiber.child;\r\n    parentNode.removeChild(fiber.node);\r\n  } else if (isFn(fiber.type)) {\r\n    if (hooks) {\r\n      hooks.layout.forEach(cleanup);\r\n      hooks.layout.forEach(effect);\r\n      hooks.layout = [];\r\n      planWork(() => {\r\n        hooks.effect.forEach(cleanup);\r\n        hooks.effect.forEach(effect);\r\n        hooks.effect = [];\r\n      });\r\n    }\r\n  } else if (op === UPDATE) {\r\n    updateElement(node, fiber.lastProps, fiber.props);\r\n  } else {\r\n    let point = fiber.insertPoint ? fiber.insertPoint.node : null;\r\n    let after = point ? point.nextSibling : parentNode.firstChild;\r\n    if (after === node) return\r\n    if (after === null && node === parentNode.lastChild) return\r\n    parentNode.insertBefore(node, after);\r\n  }\r\n  refer(ref, node);\r\n}\r\n\r\nfunction createFiber(vnode, op) {\r\n  return { ...vnode, op }\r\n}\r\n\r\nconst hashfy = c => {\r\n  const out = {};\r\n  isArr(c)\r\n    ? c.forEach((v, i) =>\r\n        isArr(v)\r\n          ? v.forEach((vi, j) => (out[hs(i, j, vi.key)] = vi))\r\n          : (out[hs(i, null, v.key)] = v)\r\n      )\r\n    : (out[hs(0, null, c.key)] = c);\r\n  return out\r\n};\r\n\r\nfunction refer(ref, dom) {\r\n  if (ref) isFn(ref) ? ref(dom) : (ref.current = dom);\r\n}\r\n\r\nfunction cleanupRef(kids) {\r\n  for (const k in kids) {\r\n    const kid = kids[k];\r\n    refer(kid.ref, null);\r\n    if (kid.kids) cleanupRef(kid.kids);\r\n  }\r\n}\r\n\r\nconst cleanup = e => e[2] && e[2]();\r\n\r\nconst effect = e => {\r\n  const res = e[0]();\r\n  if (isFn(res)) e[2] = res;\r\n};\r\n\r\nconst getCurrentFiber = () => currentFiber || null;\r\n\r\nconst isFn = fn => typeof fn === 'function';\r\n\r\nconst hs = (i, j, k) =>\r\n  k != null && j != null\r\n    ? '.' + i + '.' + k\r\n    : j != null\r\n    ? '.' + i + '.' + j\r\n    : k != null\r\n    ? '.' + k\r\n    : '.' + i;\n\nconst Fre = {\r\n  h,\r\n  Fragment,\r\n  render,\r\n  scheduleWork,\r\n  useState,\r\n  useReducer,\r\n  useEffect,\r\n  useMemo,\r\n  useCallback,\r\n  useRef,\r\n  memo\r\n};\n\nexport default Fre;\nexport { Fragment, h as createElement, h, memo, render, scheduleWork, useCallback, useEffect, useLayout, useLayout as useLayoutEffect, useMemo, useReducer, useRef, useState };\n//# sourceMappingURL=fre.esm.js.map\n","import '../polyfil'\n\nimport { h, render } from 'fre'\n\nconst App = (props) => <div>{props.foo}</div>\n\nfunction begin(target) {\n  render(<App foo='bar' />, document.getElementById(target))\n}\n\nexport { begin }\n"],"names":["window","addEventListener","WindowPrototype","DocumentPrototype","ElementPrototype","removeEventListener","dispatchEvent","registry","type","listener","target","unshift","event","currentTarget","preventDefault","returnValue","stopPropagation","cancelBubble","srcElement","call","attachEvent","index","register","detachEvent","splice","eventObject","fireEvent","Window","prototype","HTMLDocument","Element","document","createTextNode","data","text","createElement","innerText","performance","perf","now","mozNow","msNow","oNow","webkitNow","Date","getTime","isArr","Array","isArray","isStr","s","MEMO","h","attrs","props","key","ref","children","args","i","length","vnode","push","createText","some","v","concat","nodeValue","updateElement","dom","oldProps","newProps","name","oldValue","newValue","k","slice","toLowerCase","SVGElement","removeAttribute","setAttribute","fiber","tag","SVG","createElementNS","heap","node","siftUp","pop","first","last","siftDown","pi","parent","cmp","li","left","ri","right","ci","child","a","b","dueTime","peek","taskQueue","currentCallback","frameDeadline","frameLength","scheduleCallback","callback","currentTime","startTime","timeout","newTask","flush","planWork","iniTime","currentTask","didout","shouldYeild","next","flushWork","more","MessageChannel","port1","port2","onmessage","cb","requestAnimationFrame","postMessage","setTimeout","NOWORK","PLACE","UPDATE","DELETE","preCommit","WIP","updateQueue","commitQueue","render","done","rootFiber","scheduleWork","dirty","reconcileWork","shift","reconcile","bind","commitWork","parentNode","getParentNode","isFn","updateHOOK","updateHost","sibling","shouldUpdate","cloneChildren","currentFiber","resetCursor","reconcileChildren","p","insertPoint","oldFibers","kids","newFibers","hashfy","reused","newFiber","oldFiber","op","prevFiber","alternate","createFiber","lastProps","shouldPlace","newChild","forEach","c","commit","hooks","list","cleanup","cleanupRef","removeChild","layout","effect","point","after","nextSibling","firstChild","lastChild","insertBefore","refer","out","vi","j","hs","current","kid","e","res","fn","App","foo","begin","getElementById"],"mappings":"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"}